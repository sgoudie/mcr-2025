---
import { Image } from "astro:assets";

import BaseLayout from "../layouts/BaseLayout.astro";
const playlistModules = import.meta.glob("../content/playlists/*.json", { eager: true }) as Record<string, any>;
const playlists = Object.values(playlistModules) as any[];
const imageModules = import.meta.glob("../content/playlists/*.{jpg,png,webp}", { eager: true, import: "default" }) as Record<string, any>;
---

<BaseLayout title="Playlists">
  <div class="flex flex-col gap-2">
    <div class="flex flex-col gap-2 mb-6">
      <h1 class="text-3xl font-bold uppercase">Playlists</h1>
      <div class="flex flex-col gap-2">
        <p class="text-md text-gray-500">Follow our playlists on Spotify - featuring the sound of Morning Chorus alongside our new discoveries and old favourites.</p>
        <p class="text-md text-gray-500">For playlists submissions, email <a href="mailto:hello@morningchorusrecords.com" class="hover:underline">hello@morningchorusrecords.com</a></p>
      </div>
    </div>
    <ul class="grid grid-cols-1 sm:grid-cols-2 gap-10">
      {playlists.map((playlist) => {
        const imageFile = playlist.image ? playlist.image.split('/').pop() : undefined;
        const importedImage = imageFile ? imageModules[`../content/playlists/${imageFile}`] : undefined;
        return (
        <li>
          <a href={`${playlist.spotify}`}>
            {importedImage ? (
              <Image src={importedImage} alt={playlist.title} />
            ) : (
              <img src={playlist.image} alt={playlist.title} />
            )}
            <div class="flex flex-col gap-2 pt-4">
              <h2 class="text-lg font-semibold">{playlist.title}</h2>
              <p class="text-sm text-gray-500">{playlist.description}</p>
            </div>
          </a>
        </li>
        );
      })}
    </ul>
  </div>
  
</BaseLayout>